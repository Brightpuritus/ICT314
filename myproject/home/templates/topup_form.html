{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô - {{ game_name }}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/topup_form.css' %}">
</head>
<body>
    <div class="form-container">
        <div class="form-header">
            <h1>üí≥ ‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</h1>
            <p style="font-size: 1.2rem; color: #666; margin: 0;">{{ game_name }}</p>
        </div>
        {% if request.user.is_authenticated %}
            <div style="text-align:center; margin-bottom:12px; font-weight:700; color:#333;">
                ‚≠ê ‡∏û‡πâ‡∏≠‡∏¢‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: {{ user_points|default:0 }} pts
            </div>
        {% endif %}
        
        {% if errors %}
            <div class="alert alert-danger">
                <ul>
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
        
        <form method="post" action="{% url 'topup_process' game_id %}">
            {% csrf_token %}
            
            <div class="mb-4">
                <label class="form-label">üë§  ID player:</label>
                <input type="text" class="form-control" name="user" value="{{ form.user }}" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô" required>
            </div>
            
            <div class="mb-3">
                <label class="form-label">üé´ ‡πÉ‡∏ä‡πâ‡∏û‡πâ‡∏≠‡∏¢‡∏ï‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
                <input type="number" min="0" class="form-control" name="use_points" value="0" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏û‡πâ‡∏≠‡∏¢‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ (‡πÄ‡∏ä‡πà‡∏ô 50)">
                <small class="text-muted">‡∏û‡πâ‡∏≠‡∏¢‡∏ï‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</small>
            </div>
            
            <div class="mb-4">
                <label class="form-label">üí∞ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Å‡πÄ‡∏Å‡∏à:</label>
                <div class="packages-grid">
                    {% for amount in amounts %}
                        <label class="package-card" data-package="{{ amount }}">
                            <input type="radio" name="amount" value="{{ amount }}" {% if form.amount == amount|stringformat:"d" %}checked{% endif %} required>

                            <div class="package-price">‡∏ø{{ amount }}</div>
                        </label>
                    {% endfor %}
                </div>
            </div>
            
            <input type="hidden" name="game_name" value="{{ game_name }}">
            
            <button type="submit" class="btn btn-submit w-100 text-white mb-2">‚úì ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
        </form>
        
        <a href="{% url 'topup_games' %}" class="btn btn-back w-100">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</a>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.querySelectorAll('.package-card').forEach(card => {
            card.addEventListener('click', function(e) {
                if (e.target.type !== 'radio') {
                    const radio = this.querySelector('input[type="radio"]');
                    radio.checked = true;
                }
                
                document.querySelectorAll('.package-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
            });
            
            const radio = card.querySelector('input[type="radio"]');
            if (radio.checked) {
                card.classList.add('selected');
            }
        });
    </script>
</body>
</html>

